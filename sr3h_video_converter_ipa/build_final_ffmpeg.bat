@echo off
echo ========================================
echo    ุจูุงุก APK ุงูููุงุฆู ูุน FFmpeg
echo ========================================
echo.

echo ุงูุฎุทูุฉ 1: ูุณุฎ ุงูููุฏ ุงูููุงุฆู ูุน FFmpeg...
copy "lib\main_ffmpeg.dart" "lib\main.dart" /Y
echo โ ุชู ูุณุฎ ุงูููุฏ ุงูููุงุฆู ูุน FFmpeg
echo.

echo ุงูุฎุทูุฉ 2: ุงูุชุฃูุฏ ูู ุงูุฃุตูู...
if exist "M:\7j\logo.png" (
    copy "M:\7j\logo.png" "assets\images\logo.png" /Y
    echo โ ุชู ูุณุฎ ุงูุดุนุงุฑ
) else (
    echo โ๏ธ ููู ุงูุดุนุงุฑ ุบูุฑ ููุฌูุฏ
)
echo.

echo ุงูุฎุทูุฉ 3: ุชูุธูู ุดุงูู...
C:\flutter\bin\flutter clean
if exist "build" rmdir /s /q "build" 2>nul
echo โ ุชู ุงูุชูุธูู
echo.

echo ุงูุฎุทูุฉ 4: ุชุญููู ุงูุชุจุนูุงุช ูุน FFmpeg...
echo ูุฐุง ูุฏ ูุณุชุบุฑู ููุชุงู ุฃุทูู ูุชุญููู FFmpeg...
C:\flutter\bin\flutter pub get
if %errorlevel% neq 0 (
    echo โ ูุดู ูู ุชุญููู ุงูุชุจุนูุงุช
    echo ูุฑุฌู ุงูุชุญูู ูู ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช
    pause
    exit /b 1
)
echo โ ุชู ุชุญููู ุงูุชุจุนูุงุช ุจูุฌุงุญ
echo.

echo ุงูุฎุทูุฉ 5: ุจูุงุก APK ูุน FFmpeg...
echo ุชุญุฐูุฑ: ูุฐุง ูุฏ ูุณุชุบุฑู 10-15 ุฏูููุฉ ูุฃูู ูุฑุฉ
echo FFmpeg ููุชุจุฉ ูุจูุฑุฉ ูุชุญุชุงุฌ ููุช ููุชุฌููุน...
echo.
C:\flutter\bin\flutter build apk --release --verbose
if %errorlevel% neq 0 (
    echo โ ูุดู ูู ุจูุงุก APK
    echo ูุญุงููุฉ ุจูุงุก ุจุฏูู ุชุญุณููุงุช...
    C:\flutter\bin\flutter build apk --release --no-shrink --no-obfuscate
)
echo.

echo ุงูุฎุทูุฉ 6: ูุณุฎ APK ุงูููุงุฆู...
if not exist "APK_FINAL_FFMPEG" mkdir "APK_FINAL_FFMPEG"

if exist "build\app\outputs\flutter-apk\app-release.apk" (
    copy "build\app\outputs\flutter-apk\app-release.apk" "APK_FINAL_FFMPEG\ูุญูู-ุณุฑุนุฉ-v2.0.1-FFMPEG.apk"
    
    for %%A in ("APK_FINAL_FFMPEG\ูุญูู-ุณุฑุนุฉ-v2.0.1-FFMPEG.apk") do (
        echo โ APK ุงูููุงุฆู ูุน FFmpeg ุชู ุฅูุดุงุคู ุจูุฌุงุญ!
        echo ุงูุญุฌู: %%~zA bytes
        powershell -Command "Write-Host 'ุงูุญุฌู ุจุงูููุฌุงุจุงูุช: ' -NoNewline; [math]::Round(%%~zA/1MB,2)"
        echo ุงูุชุงุฑูุฎ: %%~tA
    )
    
    echo.
    echo ========================================
    echo         ุงูููุฒุงุช ุงูููุงุฆูุฉ
    echo ========================================
    echo โ 1. ุชุญููู ูุนูู ููููุฏูู ุจุงุณุชุฎุฏุงู FFmpeg
    echo โ 2. ุงูุฃูุฑ ุงููุทุจู: ffmpeg -itsscale 2 -i INPUT.mp4 -c:v copy -c:a copy OUTPUT-SR3H.mp4
    echo โ 3. ุดุนุงุฑ ุฃูุจุฑ ุญุฌูุงู (150x150)
    echo โ 4. ุฎุท Tajawal ุงูุนุฑุจู
    echo โ 5. ูุตุงุฆุญ ูุจู ุงูุชุญููู (ุฏุงุฆูุงู ุธุงูุฑุฉ)
    echo โ 6. ุฑุงุจุท ุงููููุน: www.SR3H.com
    echo โ 7. ุฒุฑ "ุญูู" ูุน ุชูุงุตูู ูุงููุฉ
    echo โ 8. ุนุฑุถ ุญุงูุฉ ุงูุชูุนูู ูุงูุจุฑูุฏ
    echo โ 9. ุฅุถุงูุฉ "-SR3H" ูุงุณู ุงูููู ุงููุญูู
    echo โ 10. ุดุฑูุท ุชูุฏู ุฃุซูุงุก ุงูุชุญููู
    echo โ 11. ุฑุณุงุฆู ุชูุตูููุฉ ุนู ูุชูุฌุฉ ุงูุชุญููู
    echo โ 12. ุญูุธ ุงููููุงุช ูู ูุฌูุฏ SR3H_Converted
    echo โ 13. ุฏุนู ุฌููุน ุฃููุงุน ุงูููุฏูู
    echo โ 14. ุฃุฐููุงุช ูุงููุฉ ูููุตูู ูููููุงุช
    echo โ 15. ูุงุฌูุฉ ูุชุฌุงูุจุฉ ููุญุณูุฉ
    echo.
    
    echo ๐ฑ APK ุงูููุงุฆู ุฌุงูุฒ ููุชูุฒูุน!
    echo ุงูููู: ูุญูู-ุณุฑุนุฉ-v2.0.1-FFMPEG.apk
    echo ุงููุฌูุฏ: APK_FINAL_FFMPEG
    echo.
    echo ุชุนูููุงุช ุงูุชุซุจูุช:
    echo 1. ุงุญุฐู ุฃู ูุณุฎุฉ ูุฏููุฉ ูู ุงูุฌูุงุฒ
    echo 2. ุงูุณุฎ ุงูููู ุงูุฌุฏูุฏ ุฅูู ุฌูุงุฒ Android
    echo 3. ูุนู "ูุตุงุฏุฑ ุบูุฑ ูุนุฑููุฉ" ูู ุงูุฅุนุฏุงุฏุงุช
    echo 4. ุซุจุช ุงูุชุทุจูู ูุงููุญ ุฌููุน ุงูุฃุฐููุงุช ุงููุทููุจุฉ
    echo 5. ุงุณุชุฎุฏู ุงูุจุฑูุฏ: test@example.com ููุชุฌุฑุจุฉ
    echo 6. ุงุฎุชุฑ ููู ููุฏูู ูุงุถุบุท "ุจุฏุก ุงูุชุญููู"
    echo.
    echo ููุงุญุธุงุช ูููุฉ:
    echo - ุงูุชุทุจูู ูุญุชุงุฌ ุฃุฐููุงุช ุงููุตูู ูููููุงุช
    echo - ุงูุชุญููู ูุฏ ูุณุชุบุฑู ููุชุงู ุญุณุจ ุญุฌู ุงูููุฏูู
    echo - ุงููููุงุช ุงููุญููุฉ ุชุญูุธ ูู ูุฌูุฏ SR3H_Converted
    echo - ูุชู ุฅุถุงูุฉ "-SR3H" ูุงุณู ุงูููู ุงููุญูู
    echo.
    
) else (
    echo โ ูุดู ูู ุฅูุดุงุก APK
    echo ูุฑุฌู ูุฑุงุฌุนุฉ ุงูุฃุฎุทุงุก ูุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู
    echo.
    echo ูุตุงุฆุญ ูุญู ุงููุดุงูู:
    echo 1. ุชุฃูุฏ ูู ูุฌูุฏ ูุณุงุญุฉ ูุงููุฉ ุนูู ุงููุฑุต ุงูุตูุจ
    echo 2. ุชุฃูุฏ ูู ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช
    echo 3. ุฃุนุฏ ุชุดุบูู ุงูููุจููุชุฑ ูุญุงูู ูุฑุฉ ุฃุฎุฑู
    echo 4. ุชุฃูุฏ ูู ุฃู Flutter ูุญุฏุซ ูุขุฎุฑ ุฅุตุฏุงุฑ
)

echo.
pause